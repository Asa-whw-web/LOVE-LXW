<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>è‡´ LXW â¤ï¸ åœ£è¯æ•…äº‹ä¹¦</title>
  <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@300;500&display=swap" rel="stylesheet">
  
  <!-- âœ… å¼•å…¥ EmailJS -->
  <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
  </script>
  <script type="text/javascript">
    (function(){
      emailjs.init("US_Rmmi-EkRTHl4bO"); // â† â† â† æ›¿æ¢ä¸ºä½ çš„ Public Key
    })();
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: "Noto Sans SC", sans-serif;
      background: linear-gradient(135deg, #0a1929, #1a3a4a, #2c5364);
      color: #333;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      padding: 1rem;
    }
    #snowflakes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    /* å¼€åœº */
    #intro {
      text-align: center;
      padding: 4rem 1rem;
      color: white;
      animation: fadeIn 2s ease-out;
    }
    #intro h1 {
      font-family: "Ma Shan Zheng", cursive;
      font-size: 3rem;
      margin-bottom: 1rem;
      text-shadow: 0 0 15px rgba(255,255,255,0.6);
    }
    #start-btn {
      margin-top: 2rem;
      padding: 0.8rem 2rem;
      background: #d4af37;
      color: #000;
      border: none;
      border-radius: 30px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1.1rem;
      transition: all 0.3s;
    }
    #start-btn:hover {
      background: #ff6b6b;
      transform: scale(1.05);
    }

    /* ä¸»å†…å®¹ */
    #main {
      display: none;
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1.5rem;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .btn-small {
      padding: 0.4rem 1rem;
      background: rgba(255,255,255,0.15);
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    .btn-small:hover {
      background: rgba(212,175,55,0.5);
    }

    /* æ•…äº‹ä¹¦ */
    .book-slider {
      position: relative;
      width: 100%;
      height: 500px;
      overflow: hidden;
      border-radius: 16px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.4);
      margin: 2rem auto;
    }
    .pages-container {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.4s cubic-bezier(0.33, 1, 0.68, 1);
    }
    .page {
      min-width: 100%;
      height: 100%;
      padding: 2.5rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: white;
    }
    .cover {
      background: linear-gradient(135deg, #8B0000, #A52A2A);
      color: white;
      font-family: "Ma Shan Zheng", cursive;
      font-size: 2.5rem;
    }
    .page-content {
      line-height: 1.7;
      font-size: 1.1rem;
      max-width: 600px;
    }

    .nav-dots {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 1rem;
    }
    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(212,175,55,0.4);
      cursor: pointer;
    }
    .dot.active {
      background: #d4af37;
    }

    #close-book {
      margin-top: 1.5rem;
      padding: 0.8rem 2rem;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      display: none;
    }

    /* === æŠ½å¡äº’åŠ¨åŒºï¼ˆå·²ä¼˜åŒ–ï¼‰=== */
    #draw-card-area {
      margin: 3rem 0;
      background: linear-gradient(135deg, #8B0000, #A52A2A);
      border-radius: 24px;
      padding: 3rem 2rem;
      box-shadow: 0 12px 40px rgba(0,0,0,0.4);
      position: relative;
      overflow: hidden;
      height: 500px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: white;
      font-family: "Ma Shan Zheng", cursive;
    }

    .card-slot {
      width: 180px;
      height: 250px;
      background: url('https://cdn.jsdelivr.net/gh/love-lxw/love-lxw@main/images/card-bg.png') center/cover no-repeat;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      z-index: 1;
      border: 3px solid gold;
      backdrop-filter: blur(2px);
      padding: 1rem;
    }
    .card-slot:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 12px 30px rgba(255,215,0,0.4);
    }
    .card-slot span {
      font-size: 1.2rem;
      color: white;
      text-shadow: 0 1px 3px rgba(0,0,0,0.6);
      line-height: 1.4;
    }

    /* å…¨å±€æç¤º */
    #wish-message {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #8B0000, #A52A2A);
      color: white;
      padding: 1.2rem 1.8rem;
      border-radius: 20px;
      font-family: "Ma Shan Zheng", cursive;
      font-size: 1.4rem;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
      transition: opacity 0.4s;
      white-space: pre-line;
      text-align: center;
      max-width: 85vw;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      border: 2px solid gold;
      backdrop-filter: blur(4px);
    }

    /* æ¨ªå±æç¤º */
    #rotate-hint {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: #0a1929;
      color: white;
      display: none;
      z-index: 2000;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Ma Shan Zheng', cursive;
      font-size: 1.4rem;
      text-align: center;
      padding: 2rem;
    }

    /* æ¨¡æ€æ¡†é€šç”¨æ ·å¼ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      z-index: 3100;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      max-width: 90vw;
      width: 360px;
      text-align: center;
      font-family: 'Noto Sans SC';
    }
    .modal-content h3 {
      margin-bottom: 1rem;
    }
    .close-btn {
      background: #aaa;
      color: white;
      border: none;
      padding: 0.5rem 1.2rem;
      border-radius: 20px;
      margin-top: 1rem;
      cursor: pointer;
    }

    /* èƒŒåŒ…çº¢ç‚¹ */
    .backpack-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: red;
      color: white;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      font-size: 0.7rem;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    /* èƒŒåŒ…å¡ç‰‡å®¹å™¨ */
    .backpack-card {
      width: 60px;
      height: 80px;
      background: white;
      border: 2px solid gold;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      font-size: 1.4rem;
      cursor: pointer;
      position: relative;
    }

    .backpack-card .count {
      margin-top: 0.2rem;
      font-weight: bold;
      font-size: 0.85rem;
      line-height: 1;
    }

    .backpack-card .type {
      font-size: 0.6rem;
      color: #555;
      line-height: 1;
      margin-top: 0.1rem;
    }

    /* å½©è›‹å¿ƒåŠ¨ç”» */
    .secret-heart.revealed {
      animation: popIn 0.4s ease-out;
    }
    @keyframes popIn {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @media (max-width: 600px) {
      .page { padding: 1.5rem; height: 450px; }
      .cover { font-size: 2rem; }
      .page-content { font-size: 1rem; }
      .book-slider { height: 450px; }
      #wish-message { font-size: 1.1rem; padding: 0.8rem 1.5rem; }
      
      #draw-card-area { 
        height: 450px; 
        padding: 2rem 1.5rem; 
      }
      .card-slot { 
        width: 140px; 
        height: 200px; 
        font-size: 1rem; 
      }
      
      .toolbar { justify-content: center; }
      .btn-small { margin: 0.2rem; }
    }
  </style>
</head>
<body>

  <!-- é£˜é›ª -->
  <div id="snowflakes"></div>

  <!-- æ¨ªå±æç¤º -->
  <div id="rotate-hint">
    <div>ğŸ“± ä¸ºäº†æ›´å¥½çš„ä½“éªŒï¼Œè¯·å°†æ‰‹æœºæ¨ªè¿‡æ¥ï¼</div>
    <div style="margin-top: 1rem; font-size: 2.5rem;">â†”ï¸</div>
  </div>

  <!-- å¼€åœº -->
  <div id="intro">
    <h1>è‡´ <span id="heart-icon" style="cursor: pointer;">â¤ï¸</span>LXW </h1>
    <p style="color:white; opacity:0.9; max-width:600px; margin:0 auto 2rem;">
      è¿™æ˜¯ä¸€ä¸ªåªå±äºæˆ‘ä»¬ä¸¤äººçš„æ•…äº‹ã€‚
    </p>
    <button id="start-btn">ç¿»å¼€ç¬¬ä¸€é¡µ ğŸ“–</button>
    <p id="hint">ï¼ˆå˜¿å˜¿!å®å®æ‰¾æ‰¾å°å½©è›‹!!ï¼‰</p>
  </div>

  <!-- ä¸»å†…å®¹ -->
  <div id="main">
    <!-- âœ… å·¥å…·æ ï¼šè¿”å›é¦–é¡µ + åˆ‡æ¢æŒ‰é’® + éŸ³ä¹ -->
    <div class="toolbar">
      <button class="btn-small" onclick="goHome()">ğŸ  è¿”å›é¦–é¡µ</button>
      <button class="btn-small" id="open-book-btn" onclick="openBookFromToolbar()" style="display:none;">ğŸ“– æ‰“å¼€æ•…äº‹ä¹¦</button>
      <button class="btn-small" id="open-card-btn" onclick="openCardFromToolbar()" style="display:none;">ğŸ æŠ½å–ç¥ç¦</button>
      <button class="btn-small" id="music-btn" onclick="toggleMusic()">ğŸ”‡ æš‚åœéŸ³ä¹</button>
    </div>

    <!-- æ•…äº‹ä¹¦éƒ¨åˆ† -->
    <div id="book-section">
      <div class="book-slider" id="bookSlider">
        <div class="pages-container" id="pagesContainer">
          <div class="page cover">
            <div>æˆ‘ä»¬çš„æ•…äº‹</div>
            <div style="font-size:1.2rem; margin-top:1rem;">â€”â€” è‡´æˆ‘æœ€çˆ±çš„ LXW</div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>åˆé‡</h2>
              <p>2025å¹´10æœˆ19æ—¥ï¼Œç¼˜åˆ†çœŸçš„å¥½å¥‡å¦™ï¼Œå‡Œæ™¨æˆ‘è¿˜åœ¨å‘æœ‹å‹åœˆæ„Ÿå¹ã€‚</p>
              <p>ä¸­åˆå°±åœ¨Soulä¸Šé‡åˆ°äº†ä½ ã€‚</p>
              <p>å½“æ—¶ä»¥ä¸ºåªæ˜¯å¯»å¸¸çš„ä¸€å¤©ï¼Œä½†æ˜¯æ…¢æ…¢çš„,å¿ƒé‡Œå¤šäº†ä¸€äº›æœŸå¾…ã€‚</p>
              <p>OS:å“¼,è‚¯å®šæ˜¯ä½ ç»™æˆ‘çŒäº†è¿·é­‚æ±¤ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>ç¬¬ä¸€æ¬¡é€šè¯</h2>
              <p>2025å¹´10æœˆ24æ—¥ï¼Œæœ‰ä¸ªå€’éœ‰è›‹è´´é’±å»å’Œå¸½å­å”å”è°ˆè¯è¿˜è¦è¢«æŸäººè´´è„¸å˜²ç¬‘ã€‚</p>
              <p>å¤ªç”Ÿæ°”äº†ï¼Œæ°”å¾—æˆ‘è„¸çº¢å¿ƒè·³çš„ã€‚ä¸å¯¹å•Šï¼Œæˆ‘è„¸çº¢ä»€ä¹ˆã€‚</p>
              <p>OSï¼šå…¶å®ä¹ŸæŒºå¹¸è¿çš„ï¼Œç¬¬ä¸€æ¬¡å¬åˆ°äº†å®å®çš„å£°éŸ³ï¼Œæ€ä¹ˆæœ‰è¿™ä¹ˆå¥½å¬çš„å£°éŸ³ï¼Œæƒ³å¬ä¸€è¾ˆå­ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>å¯»äººå¯äº‹</h2>
              <p>2025å¹´10æœˆ26æ—¥ï¼Œå¿ä¸äº†ï¼Œä½ çš„ä»€ä¹ˆä¿¡æ¯éƒ½ä¸çŸ¥é“ã€‚</p>
              <p>å¤©å¤©å°±çŸ¥é“ç¡è§‰ï¼Œä¹Ÿä¸è”ç³»æˆ‘ï¼Œä¸ä¼šä¸¢äº†å§ã€‚</p>
              <p>æœ‰ç‚¹çƒ¦ï¼Œå»è´´ä¸ªå¯»äººå¯äº‹ã€‚</p>
              <p>OSï¼šå¥¹å«æˆ‘å®å®æ¬¸ï¼Œè¿™æ ·å°±è¡Œäº†å˜›ï¼Œæˆ‘æœ‰è¿™ä¹ˆå¥½æ”¶ä¹°å˜›ã€‚</p>
              <p>                      ----å¥½å§ï¼Œç¡®å®å¯ä»¥ã€‚</p>
              <p>åè®°ï¼šå…¶å®è¿˜æœ‰ä¸€ä¸ªå¥½æ”¶ä¹°çš„ç¬¨è›‹ï¼Œä¸€ä¸ªä¼˜é…·ä¼šå‘˜å°±æ”¶ä¹°äº†ã€‚æ²¡è§è¿‡ä¸–é¢çš„æ ·å­ï¼Œå‹‰å¼ºæ”¶ç•™ä¸€ä¸‹å§ï¼Œä¸ç„¶é‡åˆ°åäººä¸çŸ¥é“å¾—è¢«éª—æˆä»€ä¹ˆæ ·å‘¢ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>çˆ±çš„æ‰¿è¯º</h2>
              <p>2025å¹´10æœˆ29æ—¥ï¼Œè¿™äººå¤ªåäº†ï¼Œæˆ‘æ·‹äº†é›¨éƒ½ä¸å®‰æ…°æˆ‘ï¼Œè¿˜æé‚£ç¬‘æˆ‘ã€‚</p>
              <p>ä½ ç­‰ç€,æˆ‘è¶…çº§è®°ä»‡çš„ã€‚</p>
              <p>å¥¹å±…ç„¶é—®æˆ‘æ„¿ä¸æ„¿æ„ä¼ºå€™å¥¹ã€‚</p>
              <p>ä¸€å¤©å¤©çš„å°±çŸ¥é“åƒå’Œç¡ï¼Œå‘µå‘µï¼Œä½ è¯´å‘¢ã€‚</p>
              <p>ä½ æ€ä¹ˆçŸ¥é“æˆ‘å–œæ¬¢å…»å±…çš„ï¼Œè¿™ä¹ˆå¯çˆ±çš„å±…å±…,å½“ç„¶è¦å…»ä¸€è¾ˆå­äº†å•¦ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>æ‡‚ç‚¹äº‹</h2>
              <p>2025å¹´11æœˆ11æ—¥ï¼Œä»Šå¤©å®å®ç”Ÿç†æœŸï¼Œå¥½å¿ƒç–¼å®å®</p>
              <p>å®Œå…¨ä¸äº†è§£æœ‰ä»€ä¹ˆç¦å¿Œå•Šï¼Œèµ¶å¿«å»æŸ¥ä¸€ä¸‹è¦æ³¨æ„äº›ä»€ä¹ˆã€‚</p>
              <p>ä½†æ˜¯æ¯ä¸ªäººä¸ä¸€æ ·å•Šï¼Œå®å®å‘¨æœŸæ˜¯å¤šå°‘å‹’ï¼Œä¸å¥½æ„æ€é—®å‘¢ã€‚</p>
              <p>å…ˆè®°å½•ä¸€ä¸‹æ—¥æœŸå§ï¼Œä¸‹æ¬¡æé†’ä¸€ä¸‹å®å®å…ˆå‡†å¤‡å¥½æš–å®å®ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>è¯´æ—©å®‰</h2>
              <p>2025å¹´11æœˆ16æ—¥ï¼Œä»Šå¤©å®å®è¯´ä»¥åè¦æ¯å¤©éƒ½è¦è¯´æ—©å®‰ã€‚</p>
              <p>å˜¿å˜¿ï¼ŒæŒºå¼€å¿ƒçš„ï¼Œå…¶å®ä¸æ˜¯æˆ‘ä¸è¯´å•¦ï¼Œåªæ˜¯æˆ‘æ€•å®å®è§‰å¾—æˆ‘çƒ¦äººã€‚</p>
              <p>è¿™ä¸‹å¯ä»¥å…‰æ˜æ­£å¤§çš„å’Œå®å®è¯´æ—©å®‰å•¦!å•¦å•¦å•¦(ï½ï¿£â–½ï¿£)ï½</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>30Day</h2>
              <p>2025å¹´11æœˆ18æ—¥ï¼Œ30å¤©ï¼Œå¾ˆå¿«å•Šï¼Œæ€ä¹ˆå°±è¿™ä¹ˆå¿«å‘¢ï¼Œéƒ½è®¤è¯†ä¸€ä¸ªæœˆäº†ã€‚</p>
              <p>å¥½æƒ³æ‰¾å®å®èŠå¤©å‘€ï¼Œç­‰æ™šä¸Šå§,å®å®åº”è¯¥ä¹Ÿå¾ˆæƒ³æ‰¾æˆ‘å§ã€‚</p>
              <p>å¯¹äº†ï¼Œæˆ‘å»æŠ˜ä¸ªç«ç‘°ï¼Œä¸å¯¹åŠ²ï¼Œæ€ä¹ˆè¿™ä¹ˆéš¾ï¼Œé¡¶ä¸ä½äº†ã€‚</p>
              <p>æ—¶é—´å¿«åˆ°äº†æ¢ä¸ªåƒçº¸é¹¤å§ï¼Œæ¥ä¸åŠäº†ï¼Œæ¥ä¸åŠäº†ï¼Œå¿«å¿«å¿«</p>
              <p>ä»€ä¹ˆå«ä¸èƒ½æ‰“ç”µè¯;ä½ è¿˜ç©é‚£ä¹ˆå¼€å¿ƒã€‚</p>
              <p>æˆ‘ä¸€ç‚¹éƒ½æ²¡æœ‰çº¢æ¸©ä¹Ÿæ²¡æœ‰ä¸å¼€å¿ƒï¼Œä¸€ç‚¹éƒ½æ²¡æœ‰!</p>
              <p>è’œé¸Ÿè’œé¸Ÿ,å®å®å¼€å¿ƒå°±å¥½ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>æ²¡æ‹›äº†</h2>
              <p>2025å¹´12æœˆ4æ—¥ï¼Œä»Šå¤©é˜¶æ®µæ±‡æŠ¥å¥½ç´¯å‘€ï¼Œä¸çŸ¥ä¸è§‰ä¹Ÿè¿™ä¹ˆä¹…å•¦ã€‚</p>
              <p>æ€ä¹ˆæ„Ÿè§‰è‡ªå·±ä¹Ÿè¶Šæ¥è¶Šä¾èµ–å®å®äº†ã€‚</p>
              <p>ç”µè¯æ–­äº†ï¼Œåˆä¸å›æˆ‘æ¶ˆæ¯ï¼Œç®—äº†ç¡è§‰ã€‚</p>
              <p>ç®—ä¸äº†ä¸€ç‚¹ï¼ŒèººåºŠä¸Šç¡ä¸ç€ï¼Œç¿»æ¥è¦†å»ç¡ä¸ç€ï¼Œèµ·æ¥å‘éªšæ‰°çŸ­ä¿¡äº†ã€‚</p>
              <p>ä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œæˆ‘å±…ç„¶ä¹Ÿä¼šæ’’å¨‡çš„ï¼ŒçœŸæ˜¯æ²¡æ‹›äº†ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>æ¼‚äº®å®å®</h2>
              <p>2025å¹´12æœˆ13æ—¥ï¼Œèµç¾ä¸Šå¸ï¼Œä»Šå¤©ç¾ç¥é™ä¸´äº†ï¼</p>
              <p>å¤©å‘ï¼æˆ‘å®å®æ€ä¹ˆè¿™ä¹ˆå¥½çœ‹ã€‚</p>
              <p>å˜¿å˜¿ï¼Œæƒ³äº²ä¸€å£,éª—ä½ çš„ï¼Œä¸æ­¢ä¸€å£ã€‚</p>
              <p>å˜¿å˜¿ï¼Œæƒ³è¦å¥½å¤šå¥½å¤šå®å®çš„ç…§ç‰‡ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>å†¬è‡³æ¼‚æµè®°</h2>
              <p>2025å¹´12æœˆ20æ—¥ï¼Œæœ‰ä¸ªç¬¨è›‹å•¥éƒ½ä¸ç®¡ï¼Œä¹Ÿå•¥éƒ½ä¸é—®ç›´æ¥å°±é£äº†ä¸€åƒå¤šå…¬é‡Œã€‚</p>
              <p>ä¸‹é£æœºï¼Œç¬¬ä¸€æ„Ÿå—å¥½çƒ­ï¼Œçœ‹äº†ä¸€çœ¼æ‰‹æœºï¼Œå¿ƒå‡‰äº†ã€‚</p>
              <p>é—­é—¨ç¾¹çœŸéš¾åƒï¼Œç®—äº†ï¼Œæ¥éƒ½æ¥äº†å»æµ·è¾¹çœ‹çœ‹å§ã€‚</p>
              <p>æ²¡æ„æ€ï¼Œæ€ä¹ˆéƒ½æˆåŒå…¥å¯¹çš„ï¼Œè¿™å…‰ä¹Ÿæ˜¯ï¼Œåˆºçæˆ‘å¾—äº†ï¼Œåæ­£ä¹Ÿç­‰ä¸åˆ°æ¶ˆæ¯ã€‚</p>
              <p>ä¸ºä»€ä¹ˆä¸æ¥ç”µè¯ï¼Œå“æ­»äº†ï¼Œå“æ­»äº†ã€‚æ€»ç®—è¿˜å¥½ï¼Œå®å®æ²¡å¤ªç”Ÿæ°”ï¼Œæºœä¹‹å¤§å‰ã€‚</p>
              <p>æ•…äº‹æ€»ç»“ï¼šå—¯ï¼Œä½ å–œæ¬¢çš„ä¸ä»£è¡¨æ‰€æœ‰äººéƒ½å–œæ¬¢ï¼Œä¸‹æ¬¡è¿˜æ˜¯å•†é‡ç€æ¥ã€‚</p>
              <p>OS:æŠ–éŸ³ä½ ç½ªå¤§æ¶æï¼Œæ¥ä¹‹å‰ä¸€ç›´ç»™æˆ‘æ¨å¼‚åœ°æ‹å¥”ç°ï¼Œç»™æˆ‘æ•´çš„çƒ­è¡€æ²¸è…¾çš„ï¼Œè¦èµ°äº†ä½ è¿˜è¿½ç€æˆ‘æ€ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>ä»Šå¤©</h2>
              <p>æˆ‘æƒ³å‘Šè¯‰å®å®ï¼šå…¶å®åœ£è¯èŠ‚å¯¹æˆ‘æ¥è¯´æ— æ‰€è°“å•¦,è®¤è¯†å®å®çš„æ¯ä¸€å¤©æˆ‘éƒ½å¾ˆå¼€å¿ƒï¼Œæˆ‘æƒ³ä¸€ç›´ä¸€ç›´å’Œå®å®åœ¨ä¸€èµ·ã€‚æ‰€ä»¥æ— è®ºæ˜¯å“ªä¸€å¤©ï¼Œæˆ‘éƒ½æƒ³å’Œå®å®ä¸€èµ·è¿‡ã€‚</p>
            </div>
          </div>
          <div class="page">
            <div class="page-content">
              <h2>æœªå®Œå¾…ç»­</h2>
              <p>æˆ‘ä»¬çš„æ•…äº‹ï¼Œæ‰åˆšåˆšå¼€å§‹ 
                <span class="secret-heart" data-num="5">â¤ï¸</span>
                <span class="secret-heart" data-num="2">â¤ï¸</span>
                <span class="secret-heart" data-num="0">â¤ï¸</span>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="nav-dots" id="navDots"></div>
      <button id="close-book" onclick="closeBook()">ğŸ“– åˆä¸Šæ•…äº‹ä¹¦</button>
    </div>

    <!-- æŠ½å¡åŒºåŸŸ -->
    <div id="card-section" style="display:none;">
      <div id="draw-card-area">
        <div class="card-slot" onclick="drawCard()">
          <span>ç‚¹å‡»æŠ½å–åœ£è¯ç¥ç¦</span>
        </div>
      </div>
      <p id="hint" style="
        color: #ffd700;
        margin-top: 1rem;
        font-size: 1rem;
        text-shadow: 0 1px 3px rgba(0,0,0,0.7);
        font-family: 'Noto Sans SC', sans-serif;
      ">é›†é½æ‰€æœ‰ç¥ç¦åï¼Œå¯è®¸æ„¿å“¦ï¼</p>

      <div style="display: flex; justify-content: center; gap: 1rem; margin-top: 1.5rem;">
        <button class="btn-small" onclick="showBackpack()" style="background: rgba(255,215,0,0.2); color: #ffd700; position: relative;">
          ğŸ’ æŸ¥çœ‹èƒŒåŒ…
          <span id="backpack-badge" class="backpack-badge" style="display:none;">!</span>
        </button>
        <button class="btn-small" onclick="showWishHistory()" style="background: rgba(255,215,0,0.2); color: #ffd700;">
          ğŸ’­ æŸ¥çœ‹æ„¿æœ›
        </button>
      </div>
    </div>
  </div>

  <!-- æ„¿æœ›è¡¨å• -->
  <div id="wish-form-modal" class="modal">
    <div class="modal-content">
      <h3>âœ¨ å†™ä¸‹ä½ çš„åœ£è¯æ„¿æœ›</h3>
      <textarea id="user-wish" rows="4" placeholder="è¯´å‡ºä½ çš„æ„¿æœ›,è¯´ä¸å®šå“ªå¤©å°±å®ç°äº†æ,å˜¿å˜¿"></textarea>
      <br>
      <button onclick="submitWish()" style="
        background: #d4af37; color: black; border: none; padding: 0.6rem 1.5rem;
        border-radius: 20px; font-weight: bold; cursor: pointer;
      ">å‘é€æ„¿æœ› ğŸ’Œ</button>
      <button onclick="closeWishForm()" class="close-btn">å–æ¶ˆ</button>
    </div>
  </div>

  <!-- èƒŒåŒ…æ¨¡æ€æ¡† -->
  <div id="backpack-modal" class="modal">
    <div class="modal-content">
      <h3>ğŸ’ ä½ çš„åœ£è¯ç¥ç¦èƒŒåŒ…</h3>
      <div id="backpack-content" style="
        margin: 1.5rem 0;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 1rem;
      "></div>
      <button id="compose-wish-btn" class="btn-small" style="
        background: #d4af37; color: black; margin-top: 1rem; display: none;
      " onclick="showWishForm()">âœ¨ åˆæˆæ„¿æœ›</button>
      <button onclick="closeBackpack()" class="close-btn">å…³é—­</button>
    </div>
  </div>

  <!-- æ„¿æœ›å†å²æ¨¡æ€æ¡† -->
  <div id="wish-history-modal" class="modal">
    <div class="modal-content" style="max-height: 70vh; overflow-y: auto;">
      <h3>ğŸ’­ ä½ çš„åœ£è¯æ„¿æœ›æ¸…å•</h3>
      <div id="wish-history-content" style="margin: 1.5rem 0; text-align: left;"></div>
      <button onclick="closeWishHistory()" class="close-btn">å…³é—­</button>
    </div>
  </div>

  <!-- æç¤ºå±‚ -->
  <div id="wish-message"></div>

  <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆå·²ä¿®å¤ï¼‰ -->
 <audio id="bgm" loop>
  <source src="christmas-piano.mp3" type="audio/mpeg">
</audio>

  <script>
  // ========== åˆå§‹åŒ–æ•°æ® ==========
  const blessingTypes = ['å¹¸ç¦å¡', 'çˆ±æƒ…å¡', 'æ—…è¡Œå¡', 'æƒŠå–œå¡', 'å¹¸è¿å¡', 'å¹³å®‰å¡', 'å¿«ä¹å¡'];
  let backpack = {};
  let wishesSent = [];
  let hasShownWishPrompt = false;
  let revealedHearts = new Set(); // ç”¨äºè®°å½•å·²æ­ç¤ºçš„å¿ƒ

  const cardIcons = {
    'å¹¸ç¦å¡': 'ğŸŒŸ',
    'çˆ±æƒ…å¡': 'ğŸ’–',
    'æ—…è¡Œå¡': 'âœ¨',
    'æƒŠå–œå¡': 'ğŸ',
    'å¹¸è¿å¡': 'ğŸ€',
    'å¹³å®‰å¡': 'ğŸ•¯ï¸',
    'å¿«ä¹å¡': 'ğŸµ'
  };

  const blessingMessages = {
    'å¹¸ç¦å¡': '2025å¹´ï¼Œæ‰€æœ‰åŠªåŠ›éƒ½ä¼šæœ‰å›æŠ¥ã€‚',
    'çˆ±æƒ…å¡': 'æˆ‘ä»¬çš„æ„Ÿæƒ…ä¼šè¶Šæ¥è¶Šç”œï¼Œåƒçƒ­çº¢é…’ä¸€æ ·æš–ã€‚',
    'æ—…è¡Œå¡': 'æˆ‘ä»¬çº¦å®šå¥½ä¸€èµ·å»ä¸€ä¸ªåœ°æ–¹æ—…æ¸¸å§ï¼',
    'æƒŠå–œå¡': 'æŸä¸ªæ¸…æ™¨ï¼Œä½ ä¼šæ”¶åˆ°ä¸€ä»½æ„æƒ³ä¸åˆ°çš„ç¤¼ç‰©ã€‚',
    'å¹¸è¿å¡': 'æ¥ä¸‹æ¥ä¸€å‘¨ï¼Œå¥½äº‹è¿è¿ï¼',
    'å¹³å®‰å¡': 'æ„¿ä½ å’Œæ‰€çˆ±ä¹‹äººï¼Œå²å²å¹³å®‰ã€‚',
    'å¿«ä¹å¡': 'æ¯å¤©é†’æ¥ï¼Œéƒ½æœ‰å€¼å¾—å¾®ç¬‘çš„ç†ç”±ã€‚'
  };

  document.addEventListener('DOMContentLoaded', () => {
    const savedBackpack = localStorage.getItem('backpack');
    const savedWishes = localStorage.getItem('christmas_wishes');
    const shownPrompt = localStorage.getItem('has_shown_wish_prompt');
    if (savedBackpack) backpack = JSON.parse(savedBackpack);
    if (savedWishes) wishesSent = JSON.parse(savedWishes);
    if (shownPrompt === 'true') hasShownWishPrompt = true;
    updateBackpackBadge();

    // ç»‘å®š â¤ï¸ é¦–é¡µå½©è›‹
    let heartClickCount = 0;
    document.getElementById('heart-icon').addEventListener('click', () => {
      heartClickCount++;
      if (heartClickCount >= 2) {
        showUnifiedMessage('ğŸ’˜', 'å¿ƒåŠ¨å½©è›‹', 'ä½ æ€ä¹ˆçŸ¥é“æˆ‘åœ¨è¿™é‡Œå‘€ï½');
        heartClickCount = 0;
      }
    });

    // ç»‘å®šæœªå®Œå¾…ç»­ â¤ï¸ å½©è›‹
    const secretHearts = document.querySelectorAll('.secret-heart');
let revealedSet = new Set(); // ä»…ç”¨äºæœ¬æ¬¡äº’åŠ¨ï¼Œä¸å­˜ localStorage

secretHearts.forEach(span => {
  span.addEventListener('dblclick', function() {
    if (this.textContent !== 'â¤ï¸') return; // å·²æ­ç¤ºåˆ™å¿½ç•¥

    const num = this.dataset.num;
    this.textContent = num;
    this.style.fontSize = '1.8rem';
    this.style.fontWeight = 'bold';
    this.style.color = '#d4af37';
    revealedSet.add(num);

    // æ£€æŸ¥æ˜¯å¦é›†é½ 520
    if (revealedSet.has('5') && revealedSet.has('2') && revealedSet.has('0')) {
      setTimeout(() => {
        showUnifiedMessage('ğŸ’', 'ç»ˆæå½©è›‹', 'æˆ‘æ°¸è¿œå–œæ¬¢ LXW â¤ï¸');

        // âœ… å…³é”®ï¼š1ç§’åæ¢å¤ä¸º â¤ï¸
        setTimeout(() => {
          secretHearts.forEach(el => {
            el.textContent = 'â¤ï¸';
            el.style.fontSize = '';
            el.style.fontWeight = '';
            el.style.color = '';
          });
          revealedSet.clear(); // æ¸…ç©ºï¼Œå…è®¸é‡æ–°ç©
        }, 1000);
      }, 300);
    }
  });
});
  });

  // ========== é£˜é›ª ==========
  const snowflakes = document.getElementById('snowflakes');
  for (let i = 0; i < 50; i++) {
    const snow = document.createElement('div');
    snow.innerHTML = 'â„';
    snow.style.position = 'absolute';
    snow.style.top = '-20px';
    snow.style.left = Math.random() * 100 + 'vw';
    snow.style.fontSize = (Math.random() * 10 + 10) + 'px';
    snow.style.opacity = Math.random() * 0.5 + 0.3;
    snow.style.animation = `fall ${Math.random() * 5 + 5}s linear infinite`;
    snow.style.color = '#fff';
    snowflakes.appendChild(snow);
  }
  document.head.insertAdjacentHTML('beforeend', `
    <style>@keyframes fall { to { transform: translateY(105vh) rotate(360deg); } }</style>
  `);

  // ========== ä¹¦é¡µæ»‘åŠ¨ ==========
  const pagesContainer = document.getElementById('pagesContainer');
  const totalPageCount = pagesContainer.children.length;
  let currentPage = 0;

  function updateSlider() {
    pagesContainer.style.transform = `translateX(-${currentPage * 100}%)`;
    updateDots();

    const isLastPage = currentPage === totalPageCount - 1;
    document.getElementById('close-book').style.display = isLastPage ? 'inline-block' : 'none';
  }

  function createDots() {
    const dotsContainer = document.getElementById('navDots');
    dotsContainer.innerHTML = '';
    for (let i = 0; i < totalPageCount; i++) {
      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.addEventListener('click', () => {
        currentPage = i;
        updateSlider();
      });
      dotsContainer.appendChild(dot);
    }
    updateDots();
  }

  function updateDots() {
    document.querySelectorAll('.dot').forEach((dot, i) => {
      dot.classList.toggle('active', i === currentPage);
    });
  }

  const slider = document.getElementById('bookSlider');
  let isDragging = false, startX = 0, currentX = 0;
  slider.addEventListener('mousedown', startDrag);
  slider.addEventListener('touchstart', e => startDrag(e.touches[0]), { passive: true });

  function startDrag(e) {
    isDragging = true;
    startX = e.clientX || e.touches?.[0].clientX;
    currentX = startX;
    document.addEventListener('mousemove', onDrag);
    document.addEventListener('touchmove', onDrag, { passive: true });
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);
  }

  function onDrag(e) {
    if (!isDragging) return;
    currentX = e.clientX || e.touches?.[0].clientX;
  }

  function endDrag() {
    if (!isDragging) return;
    const diff = startX - currentX;
    const threshold = 50;
    if (Math.abs(diff) > threshold) {
      if (diff > 0 && currentPage < totalPageCount - 1) currentPage++;
      else if (diff < 0 && currentPage > 0) currentPage--;
    }
    updateSlider();
    isDragging = false;
    document.removeEventListener('mousemove', onDrag);
    document.removeEventListener('touchmove', onDrag);
    document.removeEventListener('mouseup', endDrag);
    document.removeEventListener('touchend', endDrag);
  }

  createDots();
  updateSlider();

  // ========== è§†å›¾åˆ‡æ¢å‡½æ•° ==========
  function showBookView() {
    document.getElementById('book-section').style.display = 'block';
    document.getElementById('card-section').style.display = 'none';
    document.getElementById('open-book-btn').style.display = 'none';
    document.getElementById('open-card-btn').style.display = 'inline-block';
  }

  function showCardView() {
    document.getElementById('book-section').style.display = 'none';
    document.getElementById('card-section').style.display = 'block';
    document.getElementById('open-book-btn').style.display = 'inline-block';
    document.getElementById('open-card-btn').style.display = 'none';
  }

  function closeBook() {
    showCardView();
  }

  function openBookFromToolbar() {
    showBookView();
    currentPage = totalPageCount - 1;
    updateSlider();
  }

  function openCardFromToolbar() {
    showCardView();
  }

  // ========== æ§åˆ¶æŒ‰é’® ==========
  document.getElementById('start-btn').onclick = () => {
    document.getElementById('intro').style.display = 'none';
    document.getElementById('main').style.display = 'block';
    document.getElementById('bgm').play().catch(() => {});
    showBookView();
  };

  function goHome() {
    document.getElementById('main').style.display = 'none';
    document.getElementById('intro').style.display = 'block';
  }

  let isPlaying = true;
  function toggleMusic() {
    const bgm = document.getElementById('bgm');
    const btn = document.getElementById('music-btn');
    if (isPlaying) {
      bgm.pause();
      btn.textContent = 'ğŸ”Š æ’­æ”¾éŸ³ä¹';
    } else {
      bgm.play();
      btn.textContent = 'ğŸ”‡ æš‚åœéŸ³ä¹';
    }
    isPlaying = !isPlaying;
  }

  // ========== å…¨å±€æç¤º ==========
  function showUnifiedMessage(icon, type, message, duration = 1500) {
    const el = document.getElementById('wish-message');
    el.innerHTML = `
      <div style="font-size: 2.2rem; margin-bottom: 0.4rem;">${icon}</div>
      <div style="font-size: 1.3rem; margin-bottom: 0.6rem; color: #ffd700;">${type}</div>
      <div style="font-size: 1.1rem; line-height: 1.5;">${message}</div>
    `;
    el.style.background = 'linear-gradient(135deg, #8B0000, #A52A2A)';
    el.style.opacity = '1';
    setTimeout(() => el.style.opacity = '0', duration);
  }

  // ========== æŠ½å¡ç³»ç»Ÿ ==========
  function drawCard() {
    const type = blessingTypes[Math.floor(Math.random() * blessingTypes.length)];
    const icon = cardIcons[type];
    const message = blessingMessages[type];

    backpack[type] = (backpack[type] || 0) + 1;
    localStorage.setItem('backpack', JSON.stringify(backpack));

    showUnifiedMessage(icon, type, message);
    checkCompletion();
  }

  function checkCompletion() {
    const hasAll = blessingTypes.every(type => backpack[type] && backpack[type] > 0);
    const badge = document.getElementById('backpack-badge');
    if (hasAll) {
      badge.style.display = 'flex';
      if (!hasShownWishPrompt) {
        showUnifiedMessage('ğŸ‰', 'é›†é½å•¦ï¼', 'æ­å–œï¼ä½ é›†é½äº†æ‰€æœ‰ç¥ç¦ï¼\nå¿«å»èƒŒåŒ…é‡Œåˆæˆæ„¿æœ›å§ï½');
        hasShownWishPrompt = true;
        localStorage.setItem('has_shown_wish_prompt', 'true');
      }
    } else {
      badge.style.display = 'none';
    }
  }

  function updateBackpackBadge() {
    const hasAll = blessingTypes.every(type => backpack[type] && backpack[type] > 0);
    const badge = document.getElementById('backpack-badge');
    if (hasAll && !hasShownWishPrompt) {
      badge.style.display = 'flex';
    } else {
      badge.style.display = 'none';
    }
  }

  // ========== æ„¿æœ›è¡¨å• ==========
  function showWishForm() {
    document.getElementById('backpack-modal').style.display = 'none';
    document.getElementById('wish-form-modal').style.display = 'flex';
  }

  function closeWishForm() {
    document.getElementById('wish-form-modal').style.display = 'none';
  }

  async function submitWish() {
    const wishText = document.getElementById('user-wish').value.trim();
    if (!wishText) {
      alert('è¯·å†™ä¸‹ä½ çš„æ„¿æœ›å†å‘é€ â¤ï¸');
      return;
    }

    try {
      blessingTypes.forEach(type => {
        if (backpack[type] > 0) backpack[type]--;
      });
      localStorage.setItem('backpack', JSON.stringify(backpack));
      hasShownWishPrompt = false;
      localStorage.removeItem('has_shown_wish_prompt');

      await emailjs.send(
        'service_Asa',
        'template_whisper',
        { user_wish: wishText },
        'US_Rmmi-EkRTHl4bO'
      );

      wishesSent.push(wishText);
      localStorage.setItem('christmas_wishes', JSON.stringify(wishesSent));

      showUnifiedMessage('ğŸ’Œ', 'æ„¿æœ›å·²å‘é€', 'LXW ä¼šæ”¶åˆ°è¿™ä»½å¿ƒæ„ï½');
      closeWishForm();
      document.getElementById('user-wish').value = '';
      updateBackpackBadge();
      document.getElementById('backpack-badge').style.display = 'none';

    } catch (err) {
      console.error('å‘é€å¤±è´¥:', err);
      showUnifiedMessage('âŒ', 'å‘é€å¤±è´¥', 'æ„¿æœ›å‘é€å¤±è´¥ï¼Œæ‰¾é‚£ä¸ªç¬¨è›‹,ä»–ä»£ç å‡ºé—®é¢˜äº†ã€‚');
    }
  }

  // ========== èƒŒåŒ… & æ„¿æœ›å†å² ==========
  function showBackpack() {
    const content = document.getElementById('backpack-content');
    const composeBtn = document.getElementById('compose-wish-btn');
    content.innerHTML = '';

    let hasAny = false;
    for (const type of blessingTypes) {
      const count = backpack[type] || 0;
      if (count > 0) {
        hasAny = true;
        const cardEl = document.createElement('div');
        cardEl.className = 'backpack-card';
        cardEl.innerHTML = `
          <div>${cardIcons[type]}</div>
          <div class="count">${count}</div>
          <div class="type">${type}</div>
        `;

        // âœ… ä»…ç‚¹å‡»è§¦å‘æç¤ºï¼ˆç§»é™¤ mouseenterï¼‰
        cardEl.addEventListener('click', () => {
          showUnifiedMessage(cardIcons[type], type, blessingMessages[type]);
        });

        content.appendChild(cardEl);
      }
    }

    const hasAll = blessingTypes.every(type => backpack[type] && backpack[type] > 0);
    composeBtn.style.display = hasAll ? 'inline-block' : 'none';

    if (!hasAny) {
      content.innerHTML = '<p style="color: #888;">èƒŒåŒ…ç©ºç©ºå¦‚ä¹Ÿï¼Œå¿«å»æŠ½å¡å§ï¼</p>';
    }

    document.getElementById('backpack-modal').style.display = 'flex';
    document.getElementById('backpack-badge').style.display = 'none';
    document.getElementById('wish-message').style.zIndex = '3200';
  }

  function closeBackpack() {
    document.getElementById('backpack-modal').style.display = 'none';
    document.getElementById('wish-message').style.zIndex = '1000';
  }

  function showWishHistory() {
    const content = document.getElementById('wish-history-content');
    if (wishesSent.length === 0) {
      content.innerHTML = '<p style="color: #888;">è¿˜æ²¡æœ‰è®¸è¿‡æ„¿æœ›å“¦ï½</p>';
    } else {
      content.innerHTML = wishesSent.map((wish, i) => 
        `<div style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px dashed #eee;">
          <strong>æ„¿æœ› ${i + 1}:</strong><br>
          <span style="color: #555;">${wish}</span>
        </div>`
      ).join('');
    }
    document.getElementById('wish-history-modal').style.display = 'flex';
  }

  function closeWishHistory() {
    document.getElementById('wish-history-modal').style.display = 'none';
  }

  // ========== æ¨ªå±æ£€æµ‹ ==========
  function checkOrientation() {
    const hint = document.getElementById('rotate-hint');
    if (window.innerHeight > window.innerWidth && /Android|iPhone|iPad/i.test(navigator.userAgent)) {
      hint.style.display = 'flex';
    } else {
      hint.style.display = 'none';
    }
  }

  window.addEventListener('resize', checkOrientation);
  checkOrientation();
  </script>
</body>
</html>